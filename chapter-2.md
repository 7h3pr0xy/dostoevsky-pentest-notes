&lt;a name="main-section-4"&gt;&lt;/a&gt;

\#\# Enumeration

------------------------------------------------------------

&lt;a name="info"&gt;&lt;/a&gt;

\#\#\#\# Information Gathering

\`\`\`bash

\# Basic information

Kali&gt; whois domain.com



\# See DNS records of type

Kali&gt; dig {a\|txt\|ns\|mx} domain.com



\# Same as above but query @nameserver

Kali&gt; dig {a\|txt\|ns\|mx} domain.com @ns1.domain.com



\# E-Mail

Kali&gt; simplyemail.py -all -e TARGET-DOMAIN

\`\`\`

&lt;a name="initial"&gt;&lt;/a&gt;

\#\#\#\# Initial Scans

\#\#\#\#\#\# Fingerprinting

&gt; Banner Grabbing

\`\`\`bash

Kali&gt; nc -v $TARGET 80

Kali&gt; telnet $TARGET 80

Kali&gt; amap -bqv1 1-65535 $TARGET

\`\`\`

&gt; TTL Fingerprtinging



\| Operating System \| TTL \|

\| ---------------- \| --- \|

\| Windows \| 128 \|

\| Solaris \| 255 \|

\| Cisco \| 255 \|



&gt; Finger

\`\`\`bash

Kali&gt; finger @$TARGET

Kali&gt; finger USERNAME@$TARGET

\`\`\`



\#\#\#\#\#\# Probing

&gt; Probe for neighbors \(Especially useful for IPV6\)

\`\`\`bash

\# IPV4/IPV6

Kali&gt; netdiscover -i eth0



\# IPV6

Kali&gt; ping6 ff02::1%eth0

\`\`\`



\#\#\#\#\#\# Network Scan

\`\`\`bash

Kali&gt; nmap -sn 192.168.1.0/24

Kali&gt; nmap -sP 192.168.1.0/2

Kali&gt; for ip in $\(cat targets.txt\);do nmap -A -T4 -oN scans/nmap.$ip.txt $ip;done

\`\`\`



\#\#\#\#\#\# UDP Scans

&gt; udp-protocol-scanner

\`\`\`bash

\# Port Scan

udp-protocol-scanner.pl -f ip.txt



\# Protocol specific scan

udp-protocol-scanner -p ntp -f ips.txt

\`\`\`

&gt; Netcat

\`\`\`bash

\# UDP \(ICMP Error -&gt; Port Closed\)

Kali&gt; nc -nv -u -z -w 1 host 160-162

\`\`\`

&gt; NMAP

\`\`\`bash

Kali&gt; sudo nmap -sU -A -T3 --top-ports 100 10.10.10.24 

\`\`\`



\#\#\#\#\#\# TCP Scans

&gt; Netcat

\`\`\`bash

Kali&gt; nc -nvv -w 1 -z host 1000-2000

\`\`\`

&gt; NMAP

\`\`\`bash

Kali&gt; nmap -p 1-65535 -sV -sS -T4 $TARGET

Kali&gt; nmap -v -sS -A -T4 $TARGET

Kali&gt; nmap -v -sV -O -sS -T4 $TARGET

\`\`\`

&lt;a name="http"&gt;&lt;/a&gt;

\#\#\#\# HTTP

\#\#\#\#\#\# Stop what you are doing and go check the source code. Yes. All of it.

\#\#\#\#\#\# Directory Fuzzing

\`\`\`bash

Kali&gt; dirb http://$TARGET /usr/share/wordlists/dirb/big.txt -o dirb.txt

Kali&gt; gobuster -u http://$TARGET -w /usr/share/wordlists/dirb/big.txt -t 100



\# A little for loop so you can go do other stuff

Kali&gt; for wordlist in $\(ls\);do gobuster -u http://$TARGET -w $wordlist -t 100;done



\# dirsearch is fairly good

Kali&gt; dirsearch -u http://$TARGET -e php

\`\`\`



\#\#\#\#\#\# Website

&gt; cURL

\`\`\`bash

\# Robots can give us a clue as to where to look next you may have to send a user agent

Kali&gt; curl -s http://$TARGET/robots.txt



\# Check all the methods

Kali&gt; curl -vX OPTIONS $TARGET

\`\`\`

&gt; Nikto

\`\`\`bash

Kali&gt; nikto -h http://$TARGET

\`\`\`

&gt; BurpSuite

\`\`\`

\# I dont care who you are, or what you're doing

\# But it's time to go MANUALLY poke the website with BurpSuite

\# Play with all the things!

Get Params

Post Params

Cookies

Mess with the headers

Send random data to parameters, fuzz pages such as ?page=home

Change GET requests to POST requests

take note of 301, 302 redirects, infact take note of all error codes

I could go on and on, but man just go poke that fucker.

\`\`\`



\#\#\#\#\#\# SSL

\`\`\`bash

Kali&gt; ./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U $TARGET

\`\`\`

&lt;a name="dns"&gt;&lt;/a&gt;

\#\#\#\# DNS

\#\#\#\#\#\# Zone Transfer

\`\`\`bash

Kali&gt; host -l megacorpon.com ns1.megacorpone.com

Kali&gt; dnsrecon -d domain.com -t axfr @ns1.domain.com

Kali&gt; dnsenum domain.com

Kali&gt; nslookup -&gt; set type=any -&gt; ls -d domain.com

\`\`\`



\#\#\#\#\#\# Enumerate Subdomains

\`\`\`

Kali&gt; for sub in $\(cat subdomains.txt\);do host $sub.domain.com\|grep "has.address";done

Kali&gt; dnsrecon -d $TARGET -D wordlist.txt -t std --xml output.xml

\`\`\`

\`\`\`

\# Links

https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/

http://forensicswiki.org/wiki/Determining\_OS\_version\_from\_an\_evidence\_image

https://en.wikipedia.org/wiki/List\_of\_Microsoft\_Windows\_versions

\`\`\`

&lt;a name="databases"&gt;&lt;/a&gt;

\#\#\#\# Databases

\#\#\#\#\#\# MySQL

\`\`\`bash

TODO

\`\`\`

\#\#\#\#\#\# MSSQL

\`\`\`bash

\# NMAP

Kali&gt; nmap -sU --script=ms-sql-info $TARGET

\`\`\`

&lt;a name="ldap"&gt;&lt;/a&gt;

\#\#\#\# LDAP

\`\`\`bash

TODO



\# Links

https://n0where.net/understanding-the-ldap/

\`\`\`

&lt;a name="rpc"&gt;&lt;/a&gt;

\#\#\#\# RPC

\`\`\`bash

Kali&gt; Rpcinfo -p $TARGET

\`\`\`

&lt;a name="rdp"&gt;&lt;/a&gt;

\#\#\#\# RDP

\`\`\`bash

Kali&gt; rdesktop -u admin -p password $TARGET

\`\`\`

&lt;a name="rlogin"&gt;&lt;/a&gt;

\#\#\#\# RLogin

\`\`\`bash

Kali&gt; rlogin $TARGET



\# Sources

https://en.wikipedia.org/wiki/Rlogin

\`\`\`

&lt;a name="netbios"&gt;&lt;/a&gt;

\#\#\#\# NetBIOS

\`\`\`bash

\# Sometimes shows logged in users/addresses

Kali&gt; nbtscan $TARGET -R 54



\# Links

https://highon.coffee/blog/nbtscan-cheat-sheet/

https://technet.microsoft.com/en-us/library/cc940106.aspx?f=255&MSPPError=-2147217396

\`\`\`

&lt;a name="samba"&gt;&lt;/a&gt;

\#\#\#\# SAMBA

\`\`\`bash

\# Fingerprint version

Kali&gt; smbclient -L //$TARGET



\# TODO

Kali&gt; nmblookup -A $TARGET



\# null Session

Kali&gt; rpcclient -v "" $TARGET

Kali&gt; smbclient -L //$TARGET



\# Minimal Scan

Kali&gt; enum4linux $TARGET



\# Scan Everything

Kali&gt; enum4linux -a $TARGET



\# discover windows/samba on subnet find macs and netbios name/domain

Kali&gt; nbtscan 192.168.1.0/24



\# Find open shares

Kali&gt; nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.1.0/24   

Kali&gt; Showmount -e $TARGET/&lt;port&gt;



\# Investigate share

Kali&gt; smblookup -A $TARGET smbclient //MOUNT/share -I $TARGET -N



\# Enumerate users

Kali&gt; nmap -sU -sS --script=smb-enum-users -p U:137,T:139 192.168.11.0/24

Kali&gt; python /usr/share/doc/python-impacket-doc/examples/samrdump.py $TARGET



\# RID Cycling \(500 = admin, 501 = Guest\)

Kali&gt; ridenum.py $TARGET 500 50000 /path/to/wordlist.txt



\# NBTScan-Unixwiz

Kali&gt; nbtscan-unixwiz -f $TARGET



\# Mount Linux/Windows

Kali&gt; mount $TARGET:/vol/share /mnt/nfs

Kali&gt; Mount -t cifs //&lt;server ip&gt;/&lt;share&gt; &lt;local dir&gt; -o username=”guest”,password=””

C:\&gt;net use Z: \\win-server\share password /user:domain\janedoe /savecred /p:no



\# Links

https://pen-testing.sans.org/blog/2013/07/24/plundering-windows-account-info-via-authenticated-smb-sessions

http://www.madirish.net/59

\`\`\`

&lt;a name="smtp"&gt;&lt;/a&gt;

\#\#\#\# SMTP

\`\`\`bash

VRFY username \(verifies if username exists – enumeration of accounts\)

EXPN username \(verifies if username is valid – enumeration of accounts\)

\`\`\`

&lt;a name="snmp"&gt;&lt;/a&gt;

\#\#\#\# SNMP

\`\`\`bash

\# Overview

Default Community Names:

public, private, cisco, manager



Enumerate MIB:

1.3.6.1.2.1.25.1.6.0 System Processes

1.3.6.1.2.1.25.4.2.1.2 Running Programs

1.3.6.1.2.1.25.4.2.1.4 Processes Path

1.3.6.1.2.1.25.2.3.1.4 Storage Units

1.3.6.1.2.1.25.6.3.1.2 Software Name

1.3.6.1.4.1.77.1.2.25 User Accounts

1.3.6.1.2.1.6.13.1.3 TCP Local Ports

  

\# Enmerate users from SNMP

Kali&gt; snmpwalk public -v1 192.168.X.XXX 1 \| grep 77.1.2.25 \| cut -d” “ -f4

Kali&gt; python /usr/share/doc/python-impacket-doc/examples/samrdump.py SNMP $TARGET



\# Search SNMP with nmap

Kali&gt; nmap -sT -p 161 192.168.1.0/24 -oG snmp\_results.txt



\# Examples

Kali&gt; snmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.25.4.2.1.2

Kali&gt; onesixtyone -c community -I $TARGET

Kali&gt; snmpcheck -t $TARGET

Kali&gt; snmpenum -t $TARGET



\# Version3

Kali&gt; nmap -sV -p 161 --script=snmp-info 192.168.1.0/24



\# Wordlists

/usr/share/metasploit-framework/data/wordlists/snmp\_default\_pass.txt



\# Links

http://docwiki.cisco.com/wiki/How\_to\_get\_IPv6\_address\_via\_SNMP

https://www.pcwdld.com/what-is-snmp-and-tutorial

https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb

http://carnal0wnage.attackresearch.com/2007/07/over-in-lso-chat-we-were-talking-about.html

\`\`\`



