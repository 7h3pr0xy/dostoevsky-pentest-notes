# Recon & Enumeration

---

> It is imperative that a scout should know the history, tradition, religion, social customs, and superstitions of whatever country or people he is called on to work in or among. This is almost as necessary as to know the physical character of the country, its climate and products. Certain people will do certain things almost without fail. Certain other things, perfectly feasible, they will not do. There is no danger of knowing too much of the mental habits of an enemy. One should neither underestimate the enemy nor credit him with superhuman powers. Fear and courage are latent in every human being, though roused into activity by very diverse means.
>
> [Frederick Russell Burnham](https://en.wikipedia.org/wiki/Frederick_Russell_Burnham)

This is what I refer to as first-pass enumeration, or enumeration from the outside. We take the time to identify all running services and open ports and identify what is they are, what they do and how we can communicate with them

## Information Gathering

---

##### Basic Information

```
Kali> whois domain.com
Kali> dig {a|txt|ns|mx} domain.com
Kali> dig {a|txt|ns|mx} domain.com @ns1.domain.com
```

##### Email

```
Kali> simplyemail.py -all -e domain.com
```

## Initial Discovery

---

##### Finger Printing

> ###### Banner Grabbing

```
Kali> nc -v $TARGET 80
Kali> telnet $TARGET 80
Kali> amap -bqv1 1-65535 $TARGET
```

> ###### TTL Fingerprinting

| Operating System | TTL |
| :--- | :--- |
| Windows | 128 |
| Solaris | 225 |
| Cisco | 225 |

##### Probing Neighbors

```
# IPV4/IPV6
Kali> netdiscover -i eth0

# IPV6
Kali> ping6 ff02::1%eth0
```

##### Network Scan

```
Kali> nmap -sn 192.168.1.0/24
Kali> nmap -sP 192.168.1.0/2
Kali> for ip in $(cat targets.txt);do nmap -A -T4 -oN scans/nmap.$ip.txt $ip;done
```

##### UDP Scan

> ###### UDP-Protocol-Scanner

```
# Port Scan
udp-protocol-scanner.pl -f ip.txt

# Protocol specific scan
udp-protocol-scanner -p ntp -f ips.txt
```

> ###### Netcat

```
# UDP (ICMP Error -> Port Closed)
Kali> nc -nv -u -z -w 1 host 160-162
```

> ###### NMAP

```
Kali> sudo nmap -sU -A -T3 --top-ports 100 10.10.10.24
```

##### TCP Scan

> ###### Netcat

```
Kali> nc -nvv -w 1 -z host 1000-2000
```

> ###### NMAP

```
Kali> nmap -p 1-65535 -sV -sS -T4 $TARGET
Kali> nmap -v -sS -A -T4 $TARGET
Kali> nmap -v -sV -O -sS -T4 $TARGET
```

## Enumeration

---

##### HTTP

Stop what you're doing and go check the source code, yes all of it.

> ###### Directory Fuzzing

```
Kali> dirb http://$TARGET /usr/share/wordlists/dirb/big.txt -o dirb.txt
Kali> gobuster -u http://$TARGET -w /usr/share/wordlists/dirb/big.txt -t 100

# A little for loop so you can go do other stuff
Kali> for wordlist in $(ls);do gobuster -u http://$TARGET -w $wordlist -t 100;done

# dirsearch is fairly good
Kali> dirsearch -u http://$TARGET -e php
```

> ###### cURL

```
# Robots can give us a clue as to where to look next you may have to send a user agent
Kali> curl -s http://$TARGET/robots.txt

# Check all the methods
Kali> curl -vX OPTIONS $TARGET
```

> ###### Nikto

```
Kali> nikto -h http://$TARGET
```

> ###### BurpSuite

I don't care who you are or what you're doing but it's time to go poke the website with burp. Play with all the things, get params, post params, cookies, user agents, referrers in fact all the headers, change get requests to posts, take note of all error codes, fuzz parameter values, and names, etc.

> ###### SSL

```
Kali> ./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U $TARGET
```

##### DNS

> ###### Zone Transfer

```
Kali> host -l megacorpon.com ns1.megacorpone.com
Kali> dnsrecon -d domain.com -t axfr @ns1.domain.com
Kali> dnsenum domain.com
Kali> nslookup -> set type=any -> ls -d domain.com
```

> ###### Enumerate Subdomains

```
Kali> for sub in $(cat subdomains.txt);do host $sub.domain.com|grep "has.address";done
Kali> dnsrecon -d $TARGET -D wordlist.txt -t std --xml output.xml
```

##### DATABASES

> ###### MSSQL

```
Kali> nmap -sU --script=ms-sql-info $TARGET
```

##### LDAP

##### RPC

##### RDP

##### RLOGIN

##### NETBIOS

##### SAMBA

##### SMTP

##### SNMP



